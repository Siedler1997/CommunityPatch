--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
-- Musik Script
--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

LocalMusic = {}

--LocalMusic.MusicPath = "base\\shr\\music\\"

LocalMusic.SetEurope = {}
LocalMusic.SetEurope["summer"] = 		{
										{ "06_MiddleEurope_Summer1.mp3", 149 },										
										{ "07_MiddleEurope_Summer2.mp3", 165 },
										{ "08_MiddleEurope_Summer3.mp3", 168 },
										{ "09_MiddleEurope_Summer4.mp3", 160 },
										{ "10_MiddleEurope_Summer5.mp3", 158 },
										{ "11_MiddleEurope_Summer6.mp3", 153 },
										{ "12_MiddleEurope_Summer7.mp3", 155 },
										{ "13_MiddleEurope_Summer8.mp3", 156 },
										{ "14_MiddleEurope_Summer9.mp3", 138 },

										{ "S6_12_village_middle_europe.mp3", 77 },										
										{ "S6_16_city_middle_europe.mp3", 56 },
										{ "S6_34_back_middle_europe1.mp3", 190 },
										{ "S6_35_back_middle_europe2.mp3", 160 },
										{ "S6_36_back_middle_europe3.mp3", 171 },
										{ "S6_37_back_middle_europe4.mp3", 132 },
										{ "S6_38_back_middle_europe5.mp3", 171 },
										{ "S6_55_var_back_middle_europe2.mp3", 161 },
										{ "S6_56_var_back_middle_europe3.mp3", 162 },

										{ "06_MiddleEurope_Summer1.mp3", 149 },										
										{ "07_MiddleEurope_Summer2.mp3", 165 },
										{ "08_MiddleEurope_Summer3.mp3", 168 },
										{ "09_MiddleEurope_Summer4.mp3", 160 },
										{ "10_MiddleEurope_Summer5.mp3", 158 },
										{ "11_MiddleEurope_Summer6.mp3", 153 },
										{ "12_MiddleEurope_Summer7.mp3", 155 },
										{ "13_MiddleEurope_Summer8.mp3", 156 },
										{ "14_MiddleEurope_Summer9.mp3", 138 }
										}


LocalMusic.SetMediterranean ={}
LocalMusic.SetMediterranean["summer"] = {
										{ "15_Mediterranean_Summer1.mp3", 165 },
										{ "16_Mediterranean_Summer2.mp3", 142 },

										{ "S6_13_village_south_europe.mp3", 65 },
										{ "S6_17_city_south_europe.mp3", 67 },
										{ "S6_57_var_back_south_europe2.mp3", 162 },
										{ "S6_58_var_back_south_europe3.mp3", 174 },

										{ "15_Mediterranean_Summer1.mp3", 165 },
										{ "16_Mediterranean_Summer2.mp3", 142 },

										{ "S6_39_back_south_europe1.mp3", 171 },
										{ "S6_40_back_south_europe2.mp3", 175 },
										{ "S6_41_back_south_europe3.mp3", 149 },
										{ "S6_42_back_south_europe4.mp3", 169 },
										{ "S6_43_back_south_europe5.mp3", 118 },

										{ "15_Mediterranean_Summer1.mp3", 165 },
										{ "16_Mediterranean_Summer2.mp3", 142 }
										}

LocalMusic.SetHighland = {}
LocalMusic.SetHighland["summer"] = 		{
										{ "17_Highland_Summer1.mp3", 150 },
										{ "18_Highland_Summer2.mp3", 137 },
										
										{ "S6_11_village_north_europe.mp3", 70 },
										{ "S6_15_city_north_europe.mp3", 65 },
										{ "S6_53_var_back_north_europe2.mp3", 174 },
										{ "S6_54_var_back_north_europe3.mp3", 180 },

										{ "17_Highland_Summer1.mp3", 150 },
										{ "18_Highland_Summer2.mp3", 137 },
										
										{ "S6_29_back_north_europe1.mp3", 172 },
										{ "S6_30_back_north_europe2.mp3", 153 },
										{ "S6_31_back_north_europe3.mp3", 171 },
										{ "S6_32_back_north_europe4.mp3", 149 },
										{ "S6_33_back_north_europe5.mp3", 122 },

										{ "17_Highland_Summer1.mp3", 150 },
										{ "18_Highland_Summer2.mp3", 137 }
										}


LocalMusic.SetEvelance = {}
LocalMusic.SetEvelance["summer"] = 		{
										{ "19_Evelance_Summer1.mp3", 154 },
										{ "20_Evelance_Summer2.mp3", 152 },
										{ "21_Evelance_Summer3.mp3", 165 },
										{ "22_Evelance_Summer4.mp3", 150 },
										{ "23_Evelance_Summer5.mp3", 158 },
										{ "24_Evelance_Summer6.mp3", 168 },

										{ "DogeLongAmb.mp3", 160 },
										{ "boese_weltkarte10.mp3", 94 },
										{ "boese_weltkarte12.mp3", 239 },
										{ "SH_EvilTheme1.mp3", 74 },
										{ "SH_EvilTheme2.mp3", 171 },
										
										{ "19_Evelance_Summer1.mp3", 154 },
										{ "20_Evelance_Summer2.mp3", 152 },
										{ "21_Evelance_Summer3.mp3", 165 },
										{ "22_Evelance_Summer4.mp3", 150 },
										{ "23_Evelance_Summer5.mp3", 158 },
										{ "24_Evelance_Summer6.mp3", 168 }
										}


LocalMusic.SetEurope["snow"] = 			{
										{ "25_MiddleEurope_Winter1.mp3", 144 },
										{ "26_MiddleEurope_Winter2.mp3", 165 },						
										{ "30_MiddleEurope_Winter3.mp3", 156 },
										{ "28_Highland_Winter1.mp3", 135 }, 
										{ "27_Mediterranean_Winter1.mp3", 164 }, 
										{ "29_Evelance_Winter1.mp3", 135 }
										}


LocalMusic.SetEvelance["snow"] =		{
										{ "19_Evelance_Summer1.mp3", 154 },
										{ "20_Evelance_Summer2.mp3", 152 },
										{ "21_Evelance_Summer3.mp3", 165 },

										{ "boese_weltkarte5.mp3", 59 },
										{ "SH_IceTheme1.mp3", 186 },
										{ "SH_IceTheme2.mp3", 127 },

										{ "19_Evelance_Summer1.mp3", 154 },
										{ "20_Evelance_Summer2.mp3", 152 },
										{ "21_Evelance_Summer3.mp3", 165 }
										}


LocalMusic.SetHighland["snow"] =		{
										{ "25_MiddleEurope_Winter1.mp3", 144 }, 
										{ "26_MiddleEurope_Winter2.mp3", 165 }, 
										{ "30_MiddleEurope_Winter3.mp3", 156 },
										{ "28_Highland_Winter1.mp3", 135 }, 
										{ "27_Mediterranean_Winter1.mp3", 164 }, 
										{ "29_Evelance_Winter1.mp3", 135 }
										} 


LocalMusic.SetMediterranean["snow"] =	{
										{ "25_MiddleEurope_Winter1.mp3", 144 }, 
										{ "26_MiddleEurope_Winter2.mp3", 165 }, 
										{ "30_MiddleEurope_Winter3.mp3", 156 },
										{ "28_Highland_Winter1.mp3", 135 }, 
										{ "27_Mediterranean_Winter1.mp3", 164 }, 
										{ "29_Evelance_Winter1.mp3", 135 }
										}


LocalMusic.SetDarkMoor ={}
LocalMusic.SetDarkMoor["summer"]=		{
										{ "41_Extra1_DarkMoor_Theme1.mp3", 123 },
										{ "19_Evelance_Summer1.mp3", 154 },
										{ "20_Evelance_Summer2.mp3", 152 },
										{ "21_Evelance_Summer3.mp3", 165 },										
										{ "42_Extra1_DarkMoor_Theme2.mp3", 120 },

										{ "boese_weltkarte10.mp3", 94 },
										{ "S6_09_exploration.mp3", 126 },
										{ "SH_EvilTheme1.mp3", 74 },

										{ "41_Extra1_DarkMoor_Theme1.mp3", 123 },
										{ "42_Extra1_DarkMoor_Theme2.mp3", 120 }
										}


LocalMusic.SetDarkMoor["snow"] =		{
										{ "19_Evelance_Summer1.mp3", 154 }, 
										{ "20_Evelance_Summer2.mp3", 152 }, 
										{ "21_Evelance_Summer3.mp3", 165 },	
										{ "41_Extra1_DarkMoor_Theme1.mp3", 123 },	
										{ "42_Extra1_DarkMoor_Theme2.mp3", 120 },

										{ "boese_weltkarte5.mp3", 59 },
										{ "SH_IceTheme1.mp3", 186 },
										{ "SH_IceTheme2.mp3", 127 },
										{ "S6_09_exploration.mp3", 126 },
										
										{ "41_Extra1_DarkMoor_Theme1.mp3", 123 },	
										{ "42_Extra1_DarkMoor_Theme2.mp3", 120 }
										}


										
LocalMusic.SetBattle=  					{
										{ "03_CombatEurope1.mp3", 117 },
										{ "04_CombatMediterranean1.mp3", 113 },
										{ "05_CombatEvelance1.mp3", 117 }
										}
LocalMusic.SetEvilBattle= 				{
										{ "43_Extra1_DarkMoor_Combat.mp3", 120 }
										}

LocalMusic.SetMainTheme=				{
										{ "01_MainTheme1.mp3", 152 },
										{ "02_MainTheme2.mp3", 127 },
										{ "40_Extra1_BridgeBuild.mp3", 129 }
										}

LocalMusic.SetBriefing=					{										
										{ "40_Extra1_BridgeBuild.mp3", 129 }
										}

LocalMusic.SetBriefingOld=				{										
										{ "Win.mp3", 33 }
										}

LocalMusic.SetEurope["battle"] = 		{
										{ "03_CombatEurope1.mp3", 117 },
										{ "S6_28_combat_middle_europe_big.mp3", 110 },						
										{ "S6_63_combat_middle_europe_small.mp3", 96 }
										}
										
LocalMusic.SetHighland["battle"] =		{
										{ "03_CombatEurope1.mp3", 113 },
										{ "S6_26_combat_north_europe_big.mp3", 136 },
										{ "S6_62_combat_north_europe_small.mp3", 119 }
										}

LocalMusic.SetMediterranean["battle"] =	{
										{ "04_CombatMediterranean1.mp3", 113 },
										{ "S6_25_combat_south_europe_big.mp3", 120 },
										{ "S6_64_combat_south_europe_small.mp3", 92 },
										{ "trojans_fight_01.mp3", 128 }
										}
										
LocalMusic.SetEvelance["battle"] =		{
										{ "05_CombatEvelance1.mp3", 117 },
										{ "S6_65_combat_north_africa_small.mp3", 122 },	
										{ "43_Extra1_DarkMoor_Combat.mp3", 120 },	
										{ "honormix_01.mp3", 144 }
										}

LocalMusic.SetDarkMoor["battle"] =		{
										{ "43_Extra1_DarkMoor_Combat.mp3", 120 },	
										{ "05_CombatEvelance1.mp3", 117 },
										{ "07a1_del_torros_revenge.mp3", 129 },	
										{ "43_Extra1_DarkMoor_Combat.mp3", 120 },	
										{ "honormix_01.mp3", 144 },	
										{ "43_Extra1_DarkMoor_Combat.mp3", 120 }
										}

HIGHLANDMUSIC 		= LocalMusic.SetHighland
EUROPEMUSIC 		= LocalMusic.SetEurope
MEDITERANEANMUSIC	= LocalMusic.SetMediterranean
EVELANCEMUSIC		= LocalMusic.SetEvelance

DARKMOORMUSIC		= LocalMusic.SetDarkMoor

LocalMusic.UseSet = EUROPEMUSIC

LocalMusic.SongLength = 0
LocalMusic.BattlesOnTheMap = 0
LocalMusic.LastBattleMusicStarted = 0

function
LocalMusic_UpdateMusic()

	if LocalMusic.BattlesOnTheMap == 0 then
		--Music is playing?
		if  LocalMusic.SongLength  > XGUIEng.GetSystemTime() then	 
			return
		end	
	end

	--get current Weather
	local Weather = Logic.GetWeatherState()
	
	if Weather == 1 then
		--normal
		Weather = "summer"
	elseif Weather == 2 then
		--rain
		Weather = "summer"
	elseif Weather == 3 then
		--snow
		Weather = "snow"
	end
	
	local SetToUse
	
	if LocalMusic.BattlesOnTheMap == 1 then
		SetToUse = LocalMusic.UseSet["battle"]
	elseif LocalMusic.BattlesOnTheMap == 2 then
		SetToUse = LocalMusic.SetEvilBattle
	else
		SetToUse = LocalMusic.UseSet[Weather]
	end
	
	--is briefing running?
 	if (IsBriefingActive ~= nil and IsBriefingActive() == true )
 	 or (IsCutsceneActive~= nil and IsCutsceneActive() == true) then
		SetToUse = LocalMusic.SetBriefing
	end
	
	
	local SongAmount = table.getn(SetToUse)
	local Random = 1 + XGUIEng.GetRandom(SongAmount-1)
	local SongToPlay = Folders.Music .. SetToUse[Random][1]	
	
	
	Sound.StartMusic( SongToPlay, 127)
	LocalMusic.SongLength =  XGUIEng.GetSystemTime() + SetToUse[Random][2] + 2
	
    if LocalMusic.BattlesOnTheMap ~= 0 then
        LocalMusic.LastBattleMusicStarted = LocalMusic.SongLength
        LocalMusic.BattlesOnTheMap = 0
    end
	
	--GUI.AddNote(SetToUse[Random][1] .. " is currently playing")
	

end

-----------------------------------------------------------------------------
--Start battle music
function LocalMusic.CallbackSettlerKilled(_HurterPlayerID, _HurtPlayerID)
	local PlayerID = GUI.GetPlayerID()
	
	if _HurterPlayerID ~= _HurtPlayerID and PlayerID == _HurtPlayerID  then		
		if LocalMusic.LastBattleMusicStarted < XGUIEng.GetSystemTime() then		
			LocalMusic.BattlesOnTheMap = 1
			LocalMusic.LastBattleMusicStarted = XGUIEng.GetSystemTime() + 127
			LocalMusic.SongLength = 0
		end
	end
end